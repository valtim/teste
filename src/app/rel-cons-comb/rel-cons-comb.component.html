<app-titulo titulo="Consumo de combustível" [carregando]="!tudoPronto"></app-titulo>

<div class="container d-print-none">

    <div class="row ml-1">
        <div class="col-sm-6 col-lg-2">

            <p-listbox [options]="clientes" [(ngModel)]="clientesSelecionados" multiple="multiple" checkbox="checkbox"
                filter="filter" [listStyle]="{'max-height':'250px'}">
                <p-header>
                    Tripulantes
                </p-header>
            </p-listbox>

        </div>
        <div class="col-sm-6 col-lg-2">

            <p-listbox [options]="prefixos" [(ngModel)]="prefixosSelecionados" multiple="multiple" checkbox="checkbox"
                filter="filter" [listStyle]="{'max-height':'250px'}">
                <p-header>
                    Prefixos
                </p-header>
            </p-listbox>

        </div>

        <div class="col-sm-6 col-lg-4">
            <div class="input-group mb-3">
                <div class="input-group-append">
                    <span class="input-group-text">Inicial</span>
                </div>
                <p-calendar [(ngModel)]="dataInicio" selectionMode="single" dateFormat="dd/mm/yy" [readonlyInput]="true"
                    [locale]="locale_pt" showIcon="true"></p-calendar>

                <div class="input-group mb-3">
                    <div class="input-group-append">
                        <span class="input-group-text">Final</span>
                    </div>
                    <p-calendar [(ngModel)]="dataFim" selectionMode="single" dateFormat="dd/mm/yy"
                        [readonlyInput]="true" [locale]="locale_pt" showIcon="true"></p-calendar>
                </div>


            </div>
        </div>


        <div class="col-sm-6 col-lg-2">
            <button pButton type="button" icon="pi pi-search" iconPos="right" label="Perquisar"
                (click)="rodarRelatorio()"></button>
        </div>



    </div>


</div>

<div *ngFor="let cliente of dados">

    <p-table>
        <ng-template pTemplate="caption">
            Periodo de: {{filtroRetorno.dataInicio | date:'dd/MM/yyyy'}} até {{filtroRetorno.dataFim | date:'dd/MM/yyyy'}}
        </ng-template>
    </p-table>

    <p-table>
        <ng-template pTemplate="caption">
            Cliente: {{cliente.Titulo}}
        </ng-template>
    </p-table>

    <div *ngFor="let tabela of cliente.Tabelas">

        <p-table [columns]="cols" [value]="tabela.Tabela">
            <ng-template pTemplate="caption">
                Aeronave: {{tabela.SubTitulo}}
            </ng-template>
            <ng-template pTemplate="colgroup" let-columns>
                <colgroup>
                    <col *ngFor="let col of columns" [style.width]="col.width">
                </colgroup>
            </ng-template>
            <ng-template pTemplate="header" let-columns>
                <tr>
                    <th *ngFor="let col of columns">
                        {{col.header}}
                    </th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-columns="columns">                
                <tr *ngIf="rowData['RDV']">
                    <td>                        
                        {{rowData['Data'] | date:'dd/MM/yyyy' }}
                    </td>
                    <td>                        
                        {{rowData['RDV']}}
                    </td>
                    <td width="30%">                        
                        {{rowData['Abastecimento']}}
                    </td>
                    <td>                        
                        {{rowData['HrVoo']}}
                    </td>
                    <td>                        
                        {{rowData['Abastecido']}}
                    </td>
                    <td>                        
                        {{rowData['Consumo']}}
                    </td>
                </tr>
                
                <tr *ngIf="!rowData['RDV']">
                    <td colspan="3" class="text-right">
                        Totais por aeronave
                    </td>
                    <td>                        
                        {{rowData['HrVoo']}}
                    </td>
                    <td>                        
                        {{rowData['Abastecido']}}
                    </td>
                    <td>                        
                        {{rowData['Consumo']}}
                    </td>
                </tr>
            </ng-template>
            <!-- <ng-template pTemplate="footer" let-columns>
                <tr>
                    <td *ngFor="let col of columns">
                        {{col.header}}
                    </td>
                </tr>
            </ng-template> -->
            <!-- <ng-template pTemplate="summary">
                There are {{cars?.length}} cars
            </ng-template> -->
        </p-table>

    </div>
</div>