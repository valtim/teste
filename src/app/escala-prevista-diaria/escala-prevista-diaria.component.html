<app-loading *ngIf="loading"></app-loading>
<app-menssage></app-menssage>

<svg id="salvar" width="32px" height="32px" viewBox="0 0 512 512" (click)="salvarEscala()">
  <g>
    <rect x="248" y="352" width="16" height="96"></rect>
    <path d="M399.3,183.6c0-1.2,0.2-2.4,0.2-3.6c0-64.3-52.8-116.4-116.8-116.4c-46.1,0-85.8,27.1-104.4,66.3
  c-8.1-4.1-17.1-6.4-26.8-6.4c-29.6,0-54.1,23.6-58.9,52C57.4,187.6,32,222.2,32,261.8c0,49.7,40.1,90.2,89.6,90.2H182h31h35V205.8
  l-54.7,54.5l-11.6-11.6l74.5-74.3l74.5,74.3l-11.8,11.6L264,205.8V352h134c45,0,82-37.3,82-82.8C480,223.7,444.5,183.7,399.3,183.6
  z"></path>
  </g>
</svg>

<div class="content">

  <div style="display: flex;align-items: center;width: 300px; justify-content: space-around;">
    <label for="data" style="width: 200px;display: flex;justify-content: center; flex-direction: column; margin-bottom: 15px;">
      Data:
      <input id="data" type="date" [(ngModel)]="dataEscalaTrabalho">
    </label>
    <button (click)="onChangeDate()" style="background-color: #cecece; border: none; border-radius: 5px; padding: 5px;width: 50px;">
      <img src="assets/icons/search.svg" alt="Buscar">
    </button>
  </div>
  <button class="btn" (click)="newEscala()">Nova Escala</button>

  <table class="table trabalhos">
    <thead>
      <tr>
        <th>Tipo</th>
        <th>Matrícula</th>
        <th>Comandante</th>
        <th>1º Oficial</th>
        <th>Apresentação</th>
        <th>Lim. Refeição</th>
        <th>Base</th>
        <th>Cliente</th>
        <th>Observações</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let trabalho of escalasAtivas()">
        <td>
          {{trabalho.Prefixo.TipoDeAeronave.Nome}}
          <label for="disponivel" style="display: flex;align-items: center;">
            <input type="checkbox" name="disponivel" id="disponivel" [(ngModel)]="trabalho.Disponibilidade">
            Disponível
          </label>
        </td>
        <td>
          <div *ngIf="!trabalho.novo">
            {{trabalho.Prefixo.PrefixoCompleto}}
          </div>
          <select name="prefixo" [(ngModel)]="trabalho.Prefixo" (change)="show()" *ngIf="trabalho.novo">
            <option value="">---</option>
            <option *ngFor="let prefixo of prefixos" [ngValue]="prefixo">{{prefixo.PrefixoCompleto}}</option>
          </select>
        </td>
        <td>
          <select name="comandate" [(ngModel)]="trabalho.Escalas[0].Tripulante.Id">
            <option value="">---</option>
            <option *ngFor="let tripulante of tripulantes" value="{{tripulante.Id}}">{{tripulante.Trato}}</option>
          </select>
        </td>
        <td>
          <select name="oficial" [(ngModel)]="trabalho.Escalas[1].Tripulante.Id" *ngIf="trabalho.Prefixo.TipoDeAeronave.NumeroDeTripulantes === 2">
            <option value="">---</option>
            <option *ngFor="let tripulante of tripulantes" value="{{tripulante.Id}}">{{tripulante.Trato}}</option>
          </select>
        </td>
        <td>
          <input type="time" name="apresentacao" [(ngModel)]="trabalho.HoraDaApresentacao" (change)="onChangeApresentacao(trabalho)">
        </td>
        <td>
          <input type="time" name="refeicao" readonly [(ngModel)]="trabalho.LimiteDeRefeicao">
        </td>
        <td>
          <select name="base" [(ngModel)]="trabalho.Localidade.Id">
            <option value="">---</option>
            <option *ngFor="let base of bases" value="{{base.Id}}">{{base.NomeICAO}}</option>
          </select>
        </td>
        <td>
          <select name="cliente" [(ngModel)]="trabalho.Cliente.Id">
            <option value="">---</option>
            <option *ngFor="let cliente of clientes" value="{{cliente.Id}}">{{cliente.Nome}}</option>
          </select>
        </td>
        <td>
          <textarea name="" id="" cols="" rows="" [(ngModel)]="trabalho.Observacao"></textarea>
        </td>
        <td>
          <button class="excluir" (click)="deleteEscala(trabalho)">
            <img src="assets/icons/trash-icon.svg" alt="Lixeira">
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="info">

    <div class="coordenadorObs">
      <label for="observacao">
        Observações:
        <textarea name="observacao" id="observacao" cols="65" [(ngModel)]="escala.Comentario"></textarea>
      </label>

      <label for="coordenador">
        Coordenador:
        <input type="text" name="coordenador" id="coordenador" [(ngModel)]="escala.Coordenador">
      </label>
    </div>

    <label for="listaDistribuicao">
      Lista de Distribuição:
      <textarea name="listaDistribuicao" id="listaDistribuicao" [(ngModel)]="escala.ListaDeEmails" cols="45"></textarea>
    </label>

  </div>

</div>
